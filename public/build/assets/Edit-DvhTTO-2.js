import{u as I,r as w,j as F,k as f,a as c,b as t,d as l,h as N,t as g,w as _,c as i,e as v,o as r,f as k,v as C,T,g as b,F as P,m as z,n as x,l as G}from"./app-BUJ8XqcW.js";import{A as $}from"./AdminLayout-BWTQaCOI.js";import{_ as q,E as A,P as D,H,B as M,I as Q,F as R,L as K,a as O,b as J,T as U,c as W,U as X,C as Y}from"./ckeditor5-CIXzQw9k.js";/* empty css            */import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"max-w-4xl mx-auto bg-white p-8 rounded-xl shadow-sm border border-slate-200"},ee={class:"text-2xl font-bold text-slate-800 mb-6"},te={class:"flex gap-4 items-start bg-slate-50 p-4 rounded-lg border border-slate-100"},se={key:0,class:"w-32 h-20 shrink-0"},le=["src"],oe={class:"flex-grow"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},re={class:"col-span-2"},ie={class:"col-span-2"},ne={class:"ck-editor-wrapper"},de={class:"bg-slate-50 p-4 rounded-lg border border-slate-200 select-none"},ue={class:"flex justify-between items-center mb-3"},ce={key:0,class:"grid grid-cols-4 md:grid-cols-6 gap-3 mb-4"},be=["onClick"],me=["src"],pe=["onClick"],fe={key:1,class:"text-center p-8 border-2 border-dashed border-slate-300 rounded-lg text-slate-400 mb-4"},ge={class:"flex items-center gap-2"},ve={class:"cursor-pointer bg-white border border-slate-300 hover:border-purple-500 text-slate-600 px-4 py-2 rounded-full text-sm font-medium transition-colors shadow-sm flex items-center gap-2"},xe={key:0,class:"text-sm text-purple-600 ml-2"},ye={key:0,class:"text-sm text-red-600 mt-3 font-medium flex items-center gap-2 bg-red-50 p-2 rounded-lg border border-red-100"},he={class:"flex justify-end gap-3 pt-4 border-t border-slate-100"},we=["disabled"],_e={key:0,class:"bi bi-hourglass-split animate-spin"},ke={key:1,class:"bi bi-save"},Be={__name:"Edit",props:{post:Object},setup(m){const u=m,o=I({_method:"PUT",title:u.post.title,subtitle:u.post.subtitle,content:u.post.content,cover_image:null,gallery_images:[],remove_images:[]}),V=Y,j={licenseKey:"GPL",plugins:[A,D,H,M,Q,R,K,O,J,U,W,X],toolbar:["undo","redo","|","heading","|","bold","italic","fontSize","fontColor","|","bulletedList","numberedList","|","link","insertTable","blockQuote"],table:{contentToolbar:["tableColumn","tableRow","mergeTableCells"]}},p=w(u.post.images||[]),n=w([]),d=a=>n.value.includes(a),y=a=>{d(a)?n.value=n.value.filter(e=>e!==a):n.value.push(a)},L=()=>{n.value.forEach(a=>{h(a)}),n.value=[]},h=a=>{o.remove_images.includes(a)||o.remove_images.push(a),p.value=p.value.filter(e=>e!==a),d(a)&&y(a)},B=()=>{o.post(route("admin.board.update",u.post.id))};return(a,e)=>(r(),F($,null,{default:f(()=>[c(l(N),{title:"แก้ไขข่าวสาร"}),t("div",Z,[t("h2",ee,"แก้ไข: "+g(m.post.title),1),t("form",{onSubmit:_(B,["prevent"]),class:"space-y-6"},[t("div",te,[m.post.cover_image?(r(),i("div",se,[t("img",{src:m.post.cover_image,class:"w-full h-full object-cover rounded border bg-white"},null,8,le),e[5]||(e[5]=t("p",{class:"text-xs text-center text-slate-400 mt-1"},"รูปปัจจุบัน",-1))])):v("",!0),t("div",oe,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-slate-700 mb-1"},"เปลี่ยนรูปปก",-1)),t("input",{type:"file",onInput:e[0]||(e[0]=s=>l(o).cover_image=s.target.files[0]),class:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:bg-blue-600 file:text-white hover:file:bg-blue-700 cursor-pointer",accept:"image/*"},null,32)])]),t("div",ae,[t("div",re,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-slate-700 mb-1"},"หัวข้อ (Title)",-1)),k(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>l(o).title=s),type:"text",class:"w-full border-slate-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[C,l(o).title]])]),t("div",ie,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-slate-700 mb-1"},"คำโปรย (Subtitle)",-1)),k(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>l(o).subtitle=s),type:"text",class:"w-full border-slate-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[C,l(o).subtitle]])])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-slate-700 mb-1"},"เนื้อหา (Content)",-1)),t("div",ne,[c(l(q),{editor:l(V),modelValue:l(o).content,"onUpdate:modelValue":e[3]||(e[3]=s=>l(o).content=s),config:j},null,8,["editor","modelValue"])])]),t("div",de,[t("div",ue,[e[11]||(e[11]=t("div",null,[t("label",{class:"block text-sm font-medium text-slate-700"},"รูปภาพเพิ่มเติม (Gallery)"),t("p",{class:"text-xs text-slate-500"},"คลิกที่รูปเพื่อเลือกหลายรายการ")],-1)),c(T,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:f(()=>[n.value.length>0?(r(),i("button",{key:0,type:"button",onClick:L,class:"text-sm text-white font-bold flex items-center gap-2 bg-red-500 hover:bg-red-600 px-4 py-2 rounded-full shadow-sm transition-colors"},[e[10]||(e[10]=t("i",{class:"bi bi-trash-fill"},null,-1)),b(" ลบ "+g(n.value.length)+" รูปที่เลือก ",1)])):v("",!0)]),_:1})]),p.value.length>0?(r(),i("div",ce,[(r(!0),i(P,null,z(p.value,(s,S)=>(r(),i("div",{key:S,class:x(["relative group aspect-square rounded-lg overflow-hidden cursor-pointer border-2 transition-all duration-200",{"border-red-500 shadow-md":d(s),"border-transparent hover:border-slate-300":!d(s)}]),onClick:E=>y(s)},[t("img",{src:s,class:x(["w-full h-full object-cover bg-white transition-opacity",{"opacity-75":d(s)}])},null,10,me),t("div",{class:x(["absolute top-2 left-2 w-6 h-6 rounded-full bg-white/80 flex items-center justify-center border transition-all",{"bg-red-500 border-red-500 text-white":d(s),"border-slate-300 text-transparent group-hover:border-slate-400":!d(s)}])},[...e[12]||(e[12]=[t("i",{class:"bi bi-check-lg text-sm font-bold"},null,-1)])],2),t("button",{type:"button",onClick:_(E=>h(s),["stop"]),class:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity shadow-md hover:bg-red-600 hover:scale-110 z-10",title:"ลบรูปนี้"},[...e[13]||(e[13]=[t("i",{class:"bi bi-x-lg"},null,-1)])],8,pe)],10,be))),128))])):(r(),i("div",fe," ยังไม่มีรูปภาพในแกลเลอรี ")),t("div",ge,[t("label",ve,[e[14]||(e[14]=t("i",{class:"bi bi-cloud-upload-fill text-purple-600"},null,-1)),e[15]||(e[15]=b(" อัปโหลดรูปเพิ่ม... ",-1)),t("input",{type:"file",multiple:"",onInput:e[4]||(e[4]=s=>l(o).gallery_images=s.target.files),class:"hidden",accept:"image/*"},null,32)]),l(o).gallery_images.length>0?(r(),i("span",xe," เลือกแล้ว "+g(l(o).gallery_images.length)+" ไฟล์ ",1)):v("",!0)]),c(T,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:f(()=>[l(o).remove_images.length>0?(r(),i("p",ye,[e[16]||(e[16]=t("i",{class:"bi bi-exclamation-triangle-fill"},null,-1)),b(" ระบบจะทำการลบ "+g(l(o).remove_images.length)+' รูปภาพอย่างถาวร เมื่อคุณกดปุ่ม "บันทึกการแก้ไข" ด้านล่าง ',1)])):v("",!0)]),_:1})]),t("div",he,[c(l(G),{href:a.route("admin.board.index"),class:"px-4 py-2 bg-white border border-slate-300 text-slate-600 rounded-lg hover:bg-slate-50 transition-colors"},{default:f(()=>[...e[17]||(e[17]=[b("ยกเลิก",-1)])]),_:1},8,["href"]),t("button",{type:"submit",disabled:l(o).processing,class:"px-6 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 font-bold shadow-md hover:shadow-lg transition-all flex items-center gap-2"},[l(o).processing?(r(),i("i",_e)):(r(),i("i",ke)),e[18]||(e[18]=b(" บันทึกการแก้ไข ",-1))],8,we)])],32)])]),_:1}))}};export{Be as default};
